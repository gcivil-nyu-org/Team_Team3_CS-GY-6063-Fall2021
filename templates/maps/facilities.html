<!-- templates/registration/login.html -->
{% extends 'base.html' %}

{% block title %}Facilities{% endblock %}

{% block content %}
  
  <div style="background-color: white;">
  <div style="margin-left: 1rem;">
    <div class="flex-container" style="display:flex; gap:20px; flex-grow: 1;">

      <div class="flex-child"style="flex-basis:50%">
        <h1 class= "border-bottom mb-4">Sports Available (#{{ id }})</h1>
        {% for key, value in sports.items %}
          {% if value == 'Yes' %}
            <ul> 
              <ul>
                <h4>{{ key }}</h4>
                <div>
                  <a class="btn btn-primary" href="{% url 'add-event' key id %}" style="margin-bottom: 1rem">Create A {{key}} Event</a>
                </div>
              </ul>
            </ul>
          {% endif %}
        {% endfor %}
      </div>

      <div class="flex-child" style="flex-basis:50%; flex-direction: column;"> 

          <h1 class= "border-bottom mb-4"> Facility information </h1>
          <div style = "font-size: 18px;"><b>Name:</b> {{ name }}</div>
          <br>
          <div style = "font-size: 18px;"><b>Address</b> : <span id="address"></span></div>
          <br>
          <div style = "font-size: 18px;"><b>Location ID:</b> {{ id }}</div>
          {% comment %} <div>Description : {{ description }}</div>   {% endcomment %}
          <br>
          <div style = "font-size: 18px;"><b>Dimensions:</b> {{ dimensions }}</div>
          <br>
          <div style = "font-size: 18px;"><b>Wheelchair Accessible:</b> {{ wheelchair }}</div>

        
      </div>
    
    </div>

    <div style="margin-top: 4rem">
      <h2 class = "border-bottom mb-4">Events at this location:</h2>
      <div style="display: flex; flex-direction:row; flex-wrap: wrap">
        {% for event in events %}
          <div class="card" style="width: 20rem; margin: 1rem; border: 0.1rem solid black">
            <div class="card-body">
            <h1>
              <a href="{% url 'event-detail' event.id %}">{{event.name}}</a>
            </h1>
            <p>{{event.description}}</p>
            <p>Sport: {{event.sport}}</p>
            <p>Number of People Needed: {{event.numberOfPlayers}}</p>
            <p>Address: {{event.address}}</p>
            {% if event.borough != "" %}
              <p>Borough: {{event.borough}}</p>
            {% endif %}
            <p>{{event.date}}</p>
            <p>Creator: {{event.owner}}</p>
            </div>
          </div>
        {% endfor %}

      </div>
    </div>
  
  </div>
  </div>

<script>
  const getAddress = async () => {
    await fetch(`https://api.mapbox.com/geocoding/v5/mapbox.places/{{ coordinates.0.0.0.0 }},{{ coordinates.0.0.0.1 }}.json?access_token={{ mapbox_access_token }}`)
      .then((response) => {
        return response.json();
      })
      .then((myJson) => {
        const ADDRESS_INDEX = 0;
        const address = myJson.features[ADDRESS_INDEX].place_name;
        document.getElementById("address").textContent = address;
        return address;
      });
  }

  getAddress();
</script>

{% endblock %}
