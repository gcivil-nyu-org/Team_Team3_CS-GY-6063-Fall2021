<!-- templates/registration/login.html -->
{% extends 'base.html' %}

{% block title %}Facilities{% endblock %}

{% block content %}
<div style="background-color: white;">
<div style="margin-left: 1rem">
  <h1> Location {{ id }} </h1>
  <div>Name : {{ name }}</div>
  <div>Address : <span id="address"></span></div>
  {% comment %} <div>Description : {{ description }}</div>   {% endcomment %}

    <h2>Facility information</h2>
    <div>
      <ul>
        <li>Dimensions : {{ dimensions }}</li>
        <li>Accessible : {{ accessible }}</li>
        <li>Wheelchair : {{ wheelchair }}</li>
      <ul>
    </div>
    <div>
    <h2>Sports Available</h2>
    {% for key, value in sports.items %}
      {% if value == 'Yes' %}
        <ul> 
          <li>
            {{ key }}: {{ value}}
            <div>
              <a class="btn btn-primary" href="{% url 'add-event' key id %}" style="margin-bottom: 1rem">Create A {{key}} Event</a>
            </div>
          </li>
        </ul>
      {% endif %}
    {% endfor %}
  </div>


  <h2>Events at this location</h2>
  <div style="display: flex; flex-direction:row; flex-wrap: wrap">
    {% for event in events %}
      <div class="card" style="width: 20rem; margin: 1rem; border: 0.1rem solid black">
        <div class="card-body">
        <h1>
          <a href="{% url 'event-detail' event.id %}">{{event.name}}</a>
        </h1>
        <p>{{event.description}}</p>
        <p>Sport: {{event.sport}}</p>
        <p>{{event.address}}</p>
        {% if event.borough != "" %}
          <p>Borough: {{event.borough}}</p>
        {% endif %}
        <p>{{event.date}}</p>
        <p>Creator: {{event.owner}}</p>
        </div>
      </div>
    {% endfor %}

  </div>




</div>
</div>

<script>
  const getAddress = async () => {
    await fetch(`https://api.mapbox.com/geocoding/v5/mapbox.places/{{ coordinates.0.0.0.0 }},{{ coordinates.0.0.0.1 }}.json?access_token={{ mapbox_access_token }}`)
      .then((response) => {
        return response.json();
      })
      .then((myJson) => {
        const ADDRESS_INDEX = 0;
        const address = myJson.features[ADDRESS_INDEX].place_name;
        document.getElementById("address").textContent = address;
        return address;
      });
  }

  getAddress();
</script>

{% endblock %}
